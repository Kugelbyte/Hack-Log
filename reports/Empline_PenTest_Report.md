# ðŸ›¡ Penetration Test Report

**Client Name:** TryHackMe  
**Project Name:** Empline  
**Report Date:** 2025-05-27  
**Test Window:** 2025-05-27  
**Conducted By:** Niteesh Deshmukh  

---

## 1. Executive Summary

- **Purpose of the Test:** Obtain user and root flags by assessing the systemâ€™s weaknesses.
- **Scope Overview:** Target VM - Empline CTF hosted on TryHackMe.
- **Methodology Summary:** Performed enumeration, discovered vulnerable OpenCATS instance, exploited RCE, gained user access, and escalated to root via Linux capability misconfiguration.
- **Overall Risk Level:** High
- **Key Findings:**
  - RCE in OpenCATS 0.9.4
  - Linux binary (`ruby`) misconfigured with `cap_chown+ep` allowing root-level file manipulation

---

## 2. Assessment Scope

| Asset Type      | Asset                    | Description                        | In Scope? |
|------------------|--------------------------|------------------------------------|-----------|
| Web Application | http://job.empline.thm/  | OpenCATS instance (ATS platform)   | âœ…        |
| Host            | <IP>                     | Target VM IP address               | âœ…        |

---

## 3. Methodology

- **Standards Referenced:** OWASP, PTES  
- **Tools Used:** Nmap, linpeas, reverse shells, browser, exploit scripts  
- **Testing Phases:**
  - Reconnaissance  
  - Vulnerability Analysis  
  - Exploitation  
  - Post-Exploitation  
  - Privilege Escalation  
  - Reporting  

---

## 4. Findings Summary

| ID     | Severity | Title                                   | Affected Asset              | CVSS Score |
|--------|----------|------------------------------------------|-----------------------------|------------|
| F-001  | High     | RCE in OpenCATS 0.9.4 via file upload    | http://job.empline.thm/     | 9.8        |
| F-002  | High     | Root privilege escalation via `ruby` capability | Host <IP>           | 8.8        |

---

## 5. Detailed Findings

### F-001 â€“ Remote Code Execution in OpenCATS 0.9.4

- **Severity:** High  
- **Affected Asset:** http://job.empline.thm/  
- **Description:**  
  The OpenCATS version 0.9.4 allows unauthenticated file uploads due to poor validation, leading to arbitrary code execution.  
- **Evidence:**  
  Exploit used to upload PHP reverse shell.  
- **Impact:**  
  Full access to webserver operating system.  
- **Recommendation:**  
  - Upgrade to a patched version of OpenCATS.  
  - Implement strong file upload validation with MIME type checks.  
- **References:**  
  - [OpenCATS GitHub](https://github.com/opencats/OpenCATS)

---

### F-002 â€“ Privilege Escalation via Linux Capabilities

- **Severity:** High  
- **Affected Asset:** Host <IP>  
- **Description:**  
  The `ruby` binary had `cap_chown+ep` capability, allowing non-root users to change file ownership of critical files like `/etc/shadow`.  
- **Evidence:**
  ruby -w 'File.chown(1002, 1002, "/etc/shadow")'  
  Replaced root password hash and switched to root.
- **Impact:**  
Full root access obtained.  
- **Recommendation:**  
- Audit and restrict Linux file capabilities using `getcap -r / 2>/dev/null`.  
- Remove `cap_chown` from non-critical binaries.  
- **References:**  
- [Linux Capabilities Documentation](https://man7.org/linux/man-pages/man7/capabilities.7.html)

---

## 6. Conclusion

- The Empline VM was compromised via an RCE vulnerability in OpenCATS.
- Post-exploitation analysis revealed credentials which enabled lateral movement.
- Privilege escalation was possible due to a misconfigured `ruby` binary, allowing manipulation of critical system files.
- System administrators should patch known vulnerable applications, audit Linux capabilities, and enforce proper access controls. 
