# ðŸ›¡ Penetration Test Report

**Client Name:** TryHackMe  
**Project Name:** UltraTech CTF Lab  
**Report Date:** 2025-05-21  
**Test Window:** 2025-05-21  
**Conducted By:** Niteesh Deshmukh  

---

## 1. Executive Summary

- **Purpose of the Test:** Read root user's private SSH key by identifying and exploiting system vulnerabilities.  
- **Scope Overview:** Target machine - UltraTech room on TryHackMe.  
- **Methodology Summary:** Conducted port scanning, command injection exploitation, privilege escalation using Docker container breakout.  
- **Overall Risk Level:** High  
- **Key Findings:**
  - Command injection vulnerability on `/ping` endpoint  
  - Docker group membership allowing privilege escalation  

---

## 2. Assessment Scope

| Asset Type       | Asset             | Description             | In Scope? |
|------------------|------------------|--------------------------|-----------|
| Web Application  | http://10.10.11.121/ | /ping endpoint           | âœ…        |
| Host             | 10.10.11.121              | Target VM IP address     | âœ…        |

---

## 3. Methodology

- **Standards Referenced:** OWASP, PTES  
- **Tools Used:** Nmap, Gobuster, Crackstation, Docker, SSH  
- **Testing Phases:**
  - Reconnaissance  
  - Vulnerability Analysis  
  - Exploitation  
  - Post-Exploitation  
  - Privilege Escalation  
  - Reporting  

---

## 4. Findings Summary

| ID     | Severity | Title                            | Affected Asset     | CVSS Score |
|--------|----------|----------------------------------|--------------------|------------|
| F-001  | High     | Command Injection on /ping       | http://10.10.11.121 | 9.0        |
| F-002  | High     | Docker Group Privilege Escalation| 10.10.11.121              | 8.6        |

---

## 5. Detailed Findings

### F-001 â€“ Command Injection on /ping

- **Severity:** High  
- **Affected Asset:** http://<IP>:<PORT>  
- **Description:**  
  The `/ping` endpoint is vulnerable to command injection when user input is wrapped in backticks.  
- **Evidence:**  
  Successfully listed files using **/ping?ip=**`ls`  
- **Impact:**  
  Allows arbitrary command execution on the server.  
- **Recommendation:**  
  - Sanitize and validate input strictly.  
  - Use safe system call wrappers.  
  - Disable shell execution of unsanitized input.  
- **References:**  
  - [OWASP Command Injection](https://owasp.org/www-community/attacks/Command_Injection)

---

### F-002 â€“ Docker Group Privilege Escalation

- **Severity:** High  
- **Affected Asset:** <IP>  
- **Description:**  
  User was part of the docker group, allowing the execution of privileged containers and mounting the entire filesystem.  
- **Evidence:**  
  Used docker to mount `/` and obtain root shell via `chroot`.  
- **Impact:**  
  Full root access gained, SSH private key of root user extracted.  
- **Recommendation:**  
  - Restrict docker group membership.  
  - Use least privilege principle.  
  - Monitor group changes and docker usage.  
- **References:**  
  - [GTFOBins Docker](https://gtfobins.github.io/gtfobins/docker/)

---

## 6. Conclusion

- The UltraTech system was compromised due to a command injection vulnerability and overly permissive docker group membership.  
- These weaknesses enabled full root access and the extraction of sensitive data such as the root SSH private key.  
- Immediate remediation of input validation and user privilege policies is necessary.
